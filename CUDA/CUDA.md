# Лабораторная работа №3

Результаты простых задач и основной задачи (вариант №2) приведены в [Jupyter notebook](https://github.com/kStasya/Distributed_computing/blob/main/CUDA/CUDA.ipynb).

## Простые задачи

В задачах №2 и №4 сравнивается время работа с CUDA и СPU. 

### Задача №2.
<i>Написать программу, в которой объявлен массив из 16000 элементов и инициализирован так, что значение элемента массива равно его порядковому номеру. 
Затем создайте результирующий массив, в котором (за исключением крайних элементов) будут средние значения исходного массива: 
$b[i] = \frac{a[i-1] + a[i] + a[i+1]}{3.0}$. </i>

Работа с CPU почти в 50 раз быстрее чем с CUDA.

### Задача №4.
<i>Напишите программу перемножения больших матриц.</i>

Матрицы заполняются случайными значениями на промежутке $[0, 10]$. Работа с CPU для решения данной задачи почти в 90 раз быстрее, чем с CUDA.

### Задача №5.

<i>Напишите программу, которая читает из файла координаты точек в 3D пространстве (x,y,z) и вычисляет геометрический центр, который есть среднее по x, y и z.
Напишите две версии программы: одну с распараллеливанием цикла, другую с функциональной декомпозицией.</i>

Время работы программы с функциональной декомпозицией (расчеты раздельно по координатным осям) меньше времени работы программы с распараллеливанием цикла более 
чем в 3.5 раза.

## Основная задача
### Задача №2. 

<i>Разработайте программу для задачи вычисления определенного интеграла с использованием метода трапеций.</i>

<i>Цель работы</i>: разработать программу для вычисления определенного интеграла методом трапеции и сравнить время работы при CPU и CUDA. 

Как и в [лабораторной работе №1](https://github.com/kStasya/Distributed_computing/blob/main/OpenMP/OpenMP.md?plain=1), оптимизированы вычисления методом трапеции: значение 
подынтегральной функции на концах каждого частичного отрезка посчитывается лишь единожды, т.к. при сдвиге на шаг правый конец предыдущего частичного отрезка становится левым 
концом нового частичного отрезка, но нет нужды вычислять значение подынтегральной функции в одной и той же точке 2 раза. 

Вычисляемый интеграл имеет следующий вид:

$$ \int_{1}^{3}\big(x^3 - 3\big)dx.$$

Формулы для вычисления определенного интеграла методом трапеции:

$$ \int_{x_0}^{x_n}f(x)dx = \big(f(x_0) + f(x_n) + 2\sum_{i=1}^{n-1}f(x_i) \big) \cdot \frac{h}{2} $$

$$ x_i = x_0 + i \cdot h $$

$$ h = \frac{x_n - x_0}{n} $$

где n - число разбиений на частичные отрезки, h - шаг разбиения, $x_i$ - узлы интегрирования ($i = \overline{0, n}$) при $x_0=1$ и $x_n=3$.

Результаты также представлены в таблице:
| n      | время работы функции (CPU), мкс | время работы функции (CUDA), мкс |
|  :---: |  :---:  |  :---: | 
| 1000   | 700     | 193112 |
| 3000   | 3329    | 11     | 
| 5000   | 3045    | 11     | 
| 10000  | 9258    | 19     | 
| 15000  | 13104   | 27     |

По значениям в таблице можно увидеть, что при $n=1000$ лучше всего использовать CPU, а при $n>1000$ CUDA. В обоих случаях результаты различаются в сотни раз.
